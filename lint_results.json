[{"filePath":"C:\\Users\\deniz\\.gemini\\antigravity\\scratch\\oracle-crm\\app\\analysis\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\deniz\\.gemini\\antigravity\\scratch\\oracle-crm\\app\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\deniz\\.gemini\\antigravity\\scratch\\oracle-crm\\app\\leads\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Filter' is defined but never used.","line":4,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":24,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Filter"},"fix":{"range":[76,84],"text":""},"desc":"Remove unused variable \"Filter\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Phone' is defined but never used.","line":4,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":31,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Phone"},"fix":{"range":[84,91],"text":""},"desc":"Remove unused variable \"Phone\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CalendarIcon' is defined but never used.","line":4,"column":45,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":57,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CalendarIcon"},"fix":{"range":[91,117],"text":""},"desc":"Remove unused variable \"CalendarIcon\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'RefreshCw' is defined but never used.","line":4,"column":65,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":74,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"RefreshCw"},"fix":{"range":[123,134],"text":""},"desc":"Remove unused variable \"RefreshCw\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'X' is defined but never used.","line":4,"column":138,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":139,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"X"},"fix":{"range":[196,199],"text":""},"desc":"Remove unused variable \"X\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'format' is defined but never used.","line":14,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":16,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"format"},"fix":{"range":[819,852],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Badge' is defined but never used.","line":16,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":15,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Badge"},"fix":{"range":[892,937],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'loading' is assigned a value but never used.","line":47,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":47,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'selectedLeadId' is assigned a value but never used.","line":53,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":53,"endColumn":26},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'isReservationOpen' is assigned a value but never used.","line":54,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":54,"endColumn":29}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":10,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\"\r\n\r\nimport { useState, useEffect } from \"react\"\r\nimport { Search, Filter, Phone, Calendar as CalendarIcon, User, RefreshCw, ChevronRight, MessageCircle, Edit, CalendarDays, Copy, Check, X, Sparkles, Pin, Clock, Archive, Plus } from \"lucide-react\"\r\nimport { supabase } from \"@/lib/supabase\"\r\nimport { cn } from \"@/lib/utils\"\r\n// UI Components\r\nimport { Button } from \"@/components/ui/button\"\r\nimport { Input } from \"@/components/ui/input\"\r\nimport { Collapsible, CollapsibleContent, CollapsibleTrigger } from \"@/components/ui/collapsible\"\r\nimport { Popover, PopoverContent, PopoverTrigger } from \"@/components/ui/popover\"\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger, DialogFooter, DialogClose } from \"@/components/ui/dialog\"\r\nimport { Calendar } from \"@/components/ui/calendar\"\r\nimport { format } from \"date-fns\"\r\nimport { tr } from \"date-fns/locale\"\r\nimport { Badge } from \"@/components/ui/badge\"\r\nimport { JsonImportDialog } from \"@/components/JsonImportDialog\"\r\n\r\n// Database Type\r\ninterface Lead {\r\n    id: string\r\n    name: string\r\n    phone: string | null\r\n    source: string | null\r\n    process_name: string | null\r\n    status: string | null\r\n    created_at: string\r\n    price: number | null\r\n    ai_summary: string | null\r\n    reservation_at: string | null\r\n}\r\n\r\n// Category Configuration\r\nconst CATEGORIES = {\r\n    'Yeni': { color: 'text-green-500', bg: 'bg-green-500/10', border: 'border-green-500/20', icon: Sparkles },\r\n    'Sabit': { color: 'text-orange-500', bg: 'bg-orange-500/10', border: 'border-orange-500/20', icon: Pin },\r\n    'Takip': { color: 'text-cyan-500', bg: 'bg-cyan-500/10', border: 'border-cyan-500/20', icon: Clock },\r\n    'Arşiv': { color: 'text-slate-500', bg: 'bg-slate-500/10', border: 'border-slate-500/20', icon: Archive },\r\n} as const\r\n\r\ntype CategoryType = keyof typeof CATEGORIES\r\n\r\nconst ORDERED_CATEGORIES: CategoryType[] = ['Yeni', 'Sabit', 'Takip', 'Arşiv']\r\n\r\nexport default function LeadsPage() {\r\n    const [leads, setLeads] = useState<Lead[]>([])\r\n    const [loading, setLoading] = useState(true)\r\n    const [search, setSearch] = useState('')\r\n\r\n    // UI State\r\n    const [copiedText, setCopiedText] = useState<string | null>(null)\r\n    const [reservationDate, setReservationDate] = useState<Date | undefined>(new Date())\r\n    const [selectedLeadId, setSelectedLeadId] = useState<string | null>(null)\r\n    const [isReservationOpen, setIsReservationOpen] = useState(false)\r\n\r\n    // Expanded states for categories\r\n    const [expanded, setExpanded] = useState<Record<string, boolean>>({\r\n        'Yeni': true,\r\n        'Sabit': true,\r\n        'Takip': true,\r\n        'Arşiv': false // Archive closed by default\r\n    })\r\n\r\n    const fetchLeads = async () => {\r\n        setLoading(true)\r\n\r\n        // Supabase Check\r\n        if (!('auth' in supabase)) {\r\n            console.warn(\"Supabase not configured, using mock data\")\r\n            setLeads([\r\n                {\r\n                    id: '1', name: 'Ahmet Yılmaz', phone: '5551234567', source: 'Instagram',\r\n                    process_name: 'Bağlama', status: 'Yeni', created_at: new Date().toISOString(),\r\n                    price: 5000, ai_summary: 'Eşiyle sorun yaşıyor, acil işlem istiyor.', reservation_at: null\r\n                },\r\n                {\r\n                    id: '3', name: 'Mehmet Kaya', phone: '5331112233', source: 'Web',\r\n                    process_name: 'Rızık', status: 'Arşiv', created_at: new Date().toISOString(),\r\n                    price: 3000, ai_summary: 'İş yeri bereketi için.', reservation_at: null\r\n                }\r\n            ])\r\n            setLoading(false)\r\n            return\r\n        }\r\n\r\n        const { data, error } = await supabase\r\n            .from('leads')\r\n            .select('*')\r\n            .neq('status', 'Rezervasyon') // Exclude reservations\r\n            .order('created_at', { ascending: false })\r\n\r\n        if (error) {\r\n            console.error('Error fetching leads:', error)\r\n            setLoading(false)\r\n            return\r\n        }\r\n\r\n        setLeads(data || [])\r\n        setLoading(false)\r\n    }\r\n\r\n    useEffect(() => {\r\n        fetchLeads()\r\n    }, [])\r\n\r\n    const toggleCategory = (cat: string) => {\r\n        setExpanded(prev => ({ ...prev, [cat]: !prev[cat] }))\r\n    }\r\n\r\n    const handleCopy = (text: string) => {\r\n        navigator.clipboard.writeText(text)\r\n        setCopiedText(text)\r\n        setTimeout(() => setCopiedText(null), 2000)\r\n    }\r\n\r\n    const handleWhatsApp = (phone: string | null) => {\r\n        if (!phone) return\r\n        const cleanPhone = phone.replace(/\\D/g, '')\r\n        const finalPhone = cleanPhone.startsWith('90') ? cleanPhone : `90${cleanPhone}`\r\n        window.open(`https://web.whatsapp.com/send?phone=${finalPhone}`, '_blank')\r\n    }\r\n\r\n    const handleReservation = async (leadId: string, date: Date | undefined) => {\r\n        if (!date) return\r\n\r\n        try {\r\n            // 1. Update DB: Set date AND change status to 'Rezervasyon'\r\n            const { error } = await supabase\r\n                .from('leads')\r\n                .update({\r\n                    reservation_at: date.toISOString(),\r\n                    status: 'Rezervasyon'\r\n                })\r\n                .eq('id', leadId)\r\n\r\n            if (error) throw error\r\n\r\n            // 2. Remove from local state (optimistic update)\r\n            setLeads(prev => prev.filter(l => l.id !== leadId))\r\n\r\n            // Close popover\r\n            setIsReservationOpen(false)\r\n            setSelectedLeadId(null)\r\n        } catch (error) {\r\n            console.error('Error creating reservation:', error)\r\n        }\r\n    }\r\n\r\n    // Change Status\r\n    const updateStatus = async (id: string, newStatus: string) => {\r\n        // Optimistic UI Update\r\n        const updatedLeads = leads.map(l => l.id === id ? { ...l, status: newStatus } : l)\r\n        setLeads(updatedLeads)\r\n\r\n        if ('auth' in supabase) {\r\n            await supabase.from('leads').update({ status: newStatus }).eq('id', id)\r\n        }\r\n    }\r\n\r\n    // Filter Logic\r\n    const filteredLeads = leads.filter(lead =>\r\n        lead.name.toLowerCase().includes(search.toLowerCase()) ||\r\n        (lead.phone && lead.phone.includes(search)) ||\r\n        (lead.process_name && lead.process_name.toLowerCase().includes(search.toLowerCase()))\r\n    )\r\n\r\n    return (\r\n        <div className=\"p-8 max-w-[1600px] mx-auto space-y-8\">\r\n            {/* Header */}\r\n            <div className=\"flex flex-col md:flex-row md:items-end justify-between gap-4 border-b border-slate-800 pb-6\">\r\n                <div>\r\n                    <h1 className=\"text-3xl font-bold bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent\">\r\n                        Kayıtlar\r\n                    </h1>\r\n                    <p className=\"text-slate-400 mt-2\">\r\n                        Müşteri takibi ve yönetimi.\r\n                    </p>\r\n                </div>\r\n\r\n                <div className=\"flex items-center gap-4 w-full md:w-auto\">\r\n                    <div className=\"relative flex-1 md:w-[300px]\">\r\n                        <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 text-slate-500\" size={18} />\r\n                        <Input\r\n                            placeholder=\"İsim, telefon veya işlem ara...\"\r\n                            className=\"pl-10 bg-slate-900/50 border-slate-700 text-slate-100 placeholder:text-slate-500\"\r\n                            value={search}\r\n                            onChange={(e) => setSearch(e.target.value)}\r\n                        />\r\n                    </div>\r\n\r\n                    <div className=\"flex items-center gap-2\">\r\n                        <JsonImportDialog onSuccess={fetchLeads} />\r\n                        <Button className=\"bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white gap-2 shadow-lg shadow-purple-900/20 transition-all duration-300 hover:scale-[1.02]\">\r\n                            <Plus size={18} />\r\n                            Yeni Kayıt\r\n                        </Button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* List Layout - Grouped by Category */}\r\n            <div className=\"space-y-6\">\r\n                {ORDERED_CATEGORIES.map(category => {\r\n                    const categoryItems = filteredLeads.filter(l => (l.status || 'Yeni') === category)\r\n                    const config = CATEGORIES[category]\r\n                    const isOpen = expanded[category]\r\n\r\n                    return (\r\n                        <Collapsible\r\n                            key={category}\r\n                            open={isOpen}\r\n                            onOpenChange={() => toggleCategory(category)}\r\n                            className={cn(\r\n                                \"rounded-xl border transition-all duration-200\",\r\n                                isOpen ? \"bg-slate-900/40 border-slate-800\" : \"bg-transparent border-transparent hover:bg-slate-900/20\"\r\n                            )}\r\n                        >\r\n                            <CollapsibleTrigger asChild>\r\n                                <div className=\"flex items-center gap-3 p-4 cursor-pointer group select-none\">\r\n                                    <ChevronRight className={cn(\"text-slate-500 transition-transform duration-200\", isOpen && \"rotate-90\")} />\r\n\r\n                                    <div className={cn(\"flex items-center gap-2 px-4 py-2.5 rounded-lg border\", config.bg, config.border)}>\r\n                                        <config.icon size={20} className={config.color} />\r\n                                        <span className={cn(\"font-bold text-lg\", config.color)}>{category}</span>\r\n                                        <span className={cn(\"text-sm opacity-70 ml-1\", config.color)}>({categoryItems.length})</span>\r\n                                    </div>\r\n\r\n                                    <div className=\"flex-1 h-px bg-slate-800/50 ml-4 group-hover:bg-slate-800\" />\r\n                                </div>\r\n                            </CollapsibleTrigger>\r\n\r\n                            <CollapsibleContent>\r\n                                <div className=\"px-4 pb-4 space-y-1\">\r\n                                    {/* Header Row - Flex Layout */}\r\n                                    <div className=\"flex items-center gap-4 px-6 py-2 border-b border-slate-800/50 mb-3 text-sm font-black text-slate-400 uppercase tracking-wide\">\r\n                                        <div className=\"w-[180px] shrink-0\">İsim & Telefon</div>\r\n                                        <div className=\"w-[160px] shrink-0\">İşlem & Ücret</div>\r\n                                        <div className=\"w-[150px] shrink-0\">Durum</div>\r\n                                        <div className=\"flex-1 pl-2\">Detay (AI)</div>\r\n                                    </div>\r\n\r\n                                    {categoryItems.length === 0 ? (\r\n                                        <div className=\"p-8 text-center text-slate-600 italic text-sm font-medium\">Bu kategoride kayıt yok.</div>\r\n                                    ) : (\r\n                                        categoryItems.map(lead => (\r\n                                            <div\r\n                                                key={lead.id}\r\n                                                className=\"flex items-center gap-4 px-6 py-2 rounded-lg hover:bg-slate-800/60 transition-all duration-200 hover:scale-[1.01] hover:shadow-md border border-transparent hover:border-slate-800/50 group bg-slate-900/20\"\r\n                                            >\r\n                                                {/* Name & Phone */}\r\n                                                <div className=\"w-[180px] shrink-0 flex flex-col justify-center gap-0.5\">\r\n                                                    <div className=\"text-[13px] font-bold text-slate-200 truncate leading-tight\">{lead.name}</div>\r\n                                                    <div className=\"text-[11px] font-semibold text-slate-500/90 truncate font-sans\">{lead.phone || '-'}</div>\r\n                                                </div>\r\n\r\n                                                {/* Process & Price */}\r\n                                                <div className=\"w-[160px] shrink-0 flex flex-col justify-center gap-1\">\r\n                                                    <div className=\"flex items-center gap-2\">\r\n                                                        <div className={cn(\"w-2 h-2 rounded-full shrink-0 shadow-[0_0_8px]\",\r\n                                                            lead.process_name?.includes('Bağlama') ? \"bg-purple-500 shadow-purple-500/50\" :\r\n                                                                lead.process_name?.includes('Geri') ? \"bg-cyan-500 shadow-cyan-500/50\" :\r\n                                                                    lead.process_name?.includes('Büyü') ? \"bg-red-500 shadow-red-500/50\" :\r\n                                                                        lead.process_name?.includes('Rızık') ? \"bg-amber-500 shadow-amber-500/50\" :\r\n                                                                            \"bg-slate-500 shadow-slate-500/50\"\r\n                                                        )} />\r\n                                                        <span className=\"text-[12px] font-bold text-slate-300 truncate opacity-90\">{lead.process_name || 'İşlem Yok'}</span>\r\n                                                    </div>\r\n                                                    <div className=\"text-[11px] font-bold text-slate-500 pl-4 opacity-80\">\r\n                                                        {lead.price ? `${lead.price.toLocaleString('tr-TR')} ₺` : '-'}\r\n                                                    </div>\r\n                                                </div>\r\n\r\n                                                {/* Status Selector */}\r\n                                                <div className=\"w-[150px] shrink-0\">\r\n                                                    <Popover>\r\n                                                        <PopoverTrigger asChild>\r\n                                                            <button className={cn(\"text-[10px] font-black px-2.5 py-1 rounded-md border border-slate-800/50 hover:border-slate-700 hover:bg-slate-800 transition-all flex w-fit items-center gap-2 shadow-sm\", config.color, config.bg)}>\r\n                                                                <div className={cn(\"w-1.5 h-1.5 rounded-full\", config.bg.replace('/10', ''))} />\r\n                                                                {lead.status}\r\n                                                            </button>\r\n                                                        </PopoverTrigger>\r\n                                                        <PopoverContent className=\"w-48 p-1 bg-[#0F111A] border-slate-800 shadow-xl rounded-lg\">\r\n                                                            {ORDERED_CATEGORIES.map(cat => (\r\n                                                                <button\r\n                                                                    key={cat}\r\n                                                                    onClick={() => updateStatus(lead.id, cat)}\r\n                                                                    className={cn(\r\n                                                                        \"w-full text-left px-3 py-2.5 text-xs rounded-md hover:bg-slate-800 flex items-center gap-2.5 transition-colors\",\r\n                                                                        cat === lead.status ? \"text-white bg-slate-800/80 font-bold\" : \"text-slate-400 font-semibold\"\r\n                                                                    )}\r\n                                                                >\r\n                                                                    <div className={cn(\"w-2 h-2 rounded-full\", CATEGORIES[cat].bg.replace('/10', ''))} />\r\n                                                                    {cat}\r\n                                                                </button>\r\n                                                            ))}\r\n                                                        </PopoverContent>\r\n                                                    </Popover>\r\n                                                </div>\r\n\r\n                                                {/* AI Summary (Detail) & Actions */}\r\n                                                <div className=\"flex-1 min-w-0 flex items-center gap-6 pl-2\">\r\n                                                    <Dialog>\r\n                                                        <DialogTrigger asChild>\r\n                                                            <button className=\"text-[10px] font-semibold text-slate-500/80 hover:text-slate-300 transition-colors text-left truncate w-[260px] opacity-90 cursor-pointer\">\r\n                                                                {lead.ai_summary || 'Detay yok...'}\r\n                                                            </button>\r\n                                                        </DialogTrigger>\r\n                                                        <DialogContent className=\"bg-slate-950 border-slate-800\">\r\n                                                            <DialogHeader>\r\n                                                                <DialogTitle className=\"text-slate-100 flex items-center gap-2\">\r\n                                                                    <User size={18} className=\"text-slate-400\" />\r\n                                                                    {lead.name} - Detaylar\r\n                                                                </DialogTitle>\r\n                                                            </DialogHeader>\r\n                                                            <div className=\"mt-4 p-4 bg-slate-900/50 rounded-lg border border-slate-800 text-slate-300 text-sm leading-relaxed max-h-[60vh] overflow-y-auto\">\r\n                                                                {lead.ai_summary || \"Herhangi bir detay bulunamadı.\"}\r\n                                                            </div>\r\n                                                            <DialogFooter className=\"sm:justify-between gap-2 mt-4\">\r\n                                                                <Button\r\n                                                                    variant=\"outline\"\r\n                                                                    size=\"sm\"\r\n                                                                    onClick={() => handleCopy(lead.ai_summary || \"\")}\r\n                                                                    className=\"gap-2 border-slate-700 hover:bg-slate-800 hover:text-white\"\r\n                                                                >\r\n                                                                    {copiedText === lead.ai_summary ? <Check size={14} className=\"text-green-500\" /> : <Copy size={14} />}\r\n                                                                    {copiedText === lead.ai_summary ? \"Kopyalandı\" : \"Kopyala\"}\r\n                                                                </Button>\r\n                                                                <DialogClose asChild>\r\n                                                                    <Button variant=\"ghost\" size=\"sm\" className=\"text-slate-500 hover:text-white\">Kapat</Button>\r\n                                                                </DialogClose>\r\n                                                            </DialogFooter>\r\n                                                        </DialogContent>\r\n                                                    </Dialog>\r\n\r\n                                                    {/* Actions - Persistent & Scaled */}\r\n                                                    <div className=\"flex gap-2 shrink-0 ml-auto\">\r\n                                                        <Popover>\r\n                                                            <PopoverTrigger asChild>\r\n                                                                <Button variant=\"ghost\" size=\"icon\" className=\"h-11 w-11 text-blue-400 hover:text-blue-300 hover:bg-blue-500/10 rounded-xl transition-all hover:scale-110\" title=\"Randevu Oluştur\">\r\n                                                                    <CalendarDays size={22} />\r\n                                                                </Button>\r\n                                                            </PopoverTrigger>\r\n                                                            <PopoverContent className=\"w-auto p-0 bg-slate-950 border-slate-800\" align=\"end\">\r\n                                                                <Calendar\r\n                                                                    mode=\"single\"\r\n                                                                    selected={reservationDate}\r\n                                                                    onSelect={(date) => {\r\n                                                                        setReservationDate(date)\r\n                                                                        if (date) handleReservation(lead.id, date)\r\n                                                                    }}\r\n                                                                    locale={tr}\r\n                                                                    disabled={(date) => date < new Date(new Date().setHours(0, 0, 0, 0))}\r\n                                                                    initialFocus\r\n                                                                    className=\"p-3\"\r\n                                                                />\r\n                                                            </PopoverContent>\r\n                                                        </Popover>\r\n\r\n                                                        <Button\r\n                                                            variant=\"ghost\"\r\n                                                            size=\"icon\"\r\n                                                            onClick={() => handleWhatsApp(lead.phone)}\r\n                                                            className=\"h-11 w-11 text-green-400 hover:text-green-300 hover:bg-green-500/10 rounded-xl transition-all hover:scale-110\"\r\n                                                            title=\"WhatsApp Web\"\r\n                                                        >\r\n                                                            <MessageCircle size={22} />\r\n                                                        </Button>\r\n                                                        <Button variant=\"ghost\" size=\"icon\" className=\"h-11 w-11 text-orange-400 hover:text-orange-300 hover:bg-orange-500/10 rounded-xl transition-all hover:scale-110\" title=\"Düzenle\">\r\n                                                            <Edit size={22} />\r\n                                                        </Button>\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n                                        ))\r\n                                    )}\r\n                                </div>\r\n                            </CollapsibleContent>\r\n                        </Collapsible>\r\n                    )\r\n                })}\r\n            </div >\r\n        </div >\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\deniz\\.gemini\\antigravity\\scratch\\oracle-crm\\app\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ArrowRight' is defined but never used.","line":5,"column":75,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":85,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ArrowRight"},"fix":{"range":[135,147],"text":""},"desc":"Remove unused variable \"ArrowRight\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Tag' is defined but never used.","line":5,"column":100,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":103,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Tag"},"fix":{"range":[160,165],"text":""},"desc":"Remove unused variable \"Tag\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'loading' is assigned a value but never used.","line":24,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":24,"endColumn":17}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\n'use client'\r\n\r\nimport { useEffect, useState } from 'react'\r\nimport { CalendarCheck, Calendar, CalendarDays, CalendarRange, CalendarX, ArrowRight, User, Phone, Tag } from 'lucide-react'\r\nimport { KPICard } from '@/components/KPICard'\r\nimport { supabase } from '@/lib/supabase'\r\nimport { format, isSameDay, isThisWeek, isThisMonth, parseISO, startOfDay, isAfter } from 'date-fns'\r\nimport { tr } from 'date-fns/locale'\r\nimport { cn } from '@/lib/utils'\r\n\r\ninterface Lead {\r\n  id: string\r\n  name: string\r\n  phone?: string\r\n  status: string\r\n  reservation_at?: string\r\n  price?: number\r\n  process_name?: string\r\n}\r\n\r\nexport default function DashboardPage() {\r\n  const [leads, setLeads] = useState<Lead[]>([])\r\n  const [loading, setLoading] = useState(true)\r\n\r\n  useEffect(() => {\r\n    fetchReservations()\r\n  }, [])\r\n\r\n  const fetchReservations = async () => {\r\n    try {\r\n      const { data, error } = await supabase\r\n        .from('leads')\r\n        .select('*')\r\n        .eq('status', 'Rezervasyon')\r\n        .not('reservation_at', 'is', null) // Ensure date exists\r\n        .order('reservation_at', { ascending: true })\r\n\r\n      if (error) throw error\r\n      setLeads(data || [])\r\n    } catch (error) {\r\n      console.error('Error fetching reservations:', error)\r\n    } finally {\r\n      setLoading(false)\r\n    }\r\n  }\r\n\r\n  // Filter Stats\r\n  const now = new Date()\r\n  const upcomingLeads = leads.filter(l => {\r\n    if (!l.reservation_at) return false\r\n    return isAfter(parseISO(l.reservation_at), startOfDay(now)) || isSameDay(parseISO(l.reservation_at), now)\r\n  })\r\n\r\n  const STATS = {\r\n    total: leads.length,\r\n    today: leads.filter(l => l.reservation_at && isSameDay(parseISO(l.reservation_at), now)).length,\r\n    week: leads.filter(l => l.reservation_at && isThisWeek(parseISO(l.reservation_at), { weekStartsOn: 1 })).length,\r\n    month: leads.filter(l => l.reservation_at && isThisMonth(parseISO(l.reservation_at))).length\r\n  }\r\n\r\n  // Group by Date for UI\r\n  const groupedReservations = upcomingLeads.reduce((groups, lead) => {\r\n    const date = format(parseISO(lead.reservation_at!), 'yyyy-MM-dd')\r\n    if (!groups[date]) groups[date] = []\r\n    groups[date].push(lead)\r\n    return groups\r\n  }, {} as Record<string, Lead[]>)\r\n\r\n  // Sort dates\r\n  const sortedDates = Object.keys(groupedReservations).sort((a, b) => a.localeCompare(b))\r\n\r\n  return (\r\n    <div className=\"p-8 max-w-7xl mx-auto space-y-8\">\r\n      {/* Header */}\r\n      <div className=\"flex items-center gap-3\">\r\n        <div className=\"p-3 bg-purple-500/10 rounded-xl border border-purple-500/20\">\r\n          <CalendarCheck className=\"text-purple-400\" size={32} />\r\n        </div>\r\n        <div>\r\n          <h1 className=\"text-3xl font-bold text-white tracking-tight\">Yaklaşan Rezervasyonlar</h1>\r\n          <p className=\"text-slate-400\">Takvim ve rezervasyon takibi</p>\r\n        </div>\r\n      </div>\r\n\r\n      {/* KPI Cards */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\r\n        <KPICard\r\n          title=\"Toplam Kayıt\"\r\n          value={STATS.total.toString()}\r\n          icon={CalendarCheck}\r\n          colorClass=\"text-purple-400\"\r\n          bgClass=\"bg-purple-500/15\"\r\n          borderClass=\"border-purple-500/30\"\r\n        />\r\n        <KPICard\r\n          title=\"Bugün\"\r\n          value={STATS.today.toString()}\r\n          icon={Calendar}\r\n          colorClass=\"text-green-400\"\r\n          bgClass=\"bg-green-500/15\"\r\n          borderClass=\"border-green-500/30\"\r\n        />\r\n        <KPICard\r\n          title=\"Bu Hafta\"\r\n          value={STATS.week.toString()}\r\n          icon={CalendarDays}\r\n          colorClass=\"text-blue-400\"\r\n          bgClass=\"bg-blue-500/15\"\r\n          borderClass=\"border-blue-500/30\"\r\n        />\r\n        <KPICard\r\n          title=\"Bu Ay\"\r\n          value={STATS.month.toString()}\r\n          icon={CalendarRange}\r\n          colorClass=\"text-fuchsia-400\"\r\n          bgClass=\"bg-fuchsia-500/15\"\r\n          borderClass=\"border-fuchsia-500/30\"\r\n        />\r\n      </div>\r\n\r\n      {/* Content Area - Horizontal Scroll */}\r\n      {sortedDates.length === 0 ? (\r\n        <div className=\"bg-slate-900/40 border border-slate-800/50 rounded-2xl min-h-[400px] flex flex-col items-center justify-center text-center\">\r\n          <CalendarX size={64} className=\"text-slate-800 mb-6\" />\r\n          <p className=\"text-xl text-slate-400 font-medium\">Yaklaşan rezervasyon bulunmuyor</p>\r\n          <p className=\"text-sm text-slate-600 mt-2\">Kayıtlar ekranından yeni bir tarih belirleyebilirsiniz.</p>\r\n        </div>\r\n      ) : (\r\n        <div className=\"overflow-x-auto pb-6\">\r\n          <div className=\"flex gap-6 min-w-max px-1\">\r\n            {sortedDates.map(dateStr => {\r\n              const items = groupedReservations[dateStr]\r\n              const dateObj = parseISO(dateStr)\r\n              const isToday = isSameDay(dateObj, now)\r\n\r\n              return (\r\n                <div\r\n                  key={dateStr}\r\n                  className={cn(\r\n                    \"w-[340px] shrink-0 rounded-2xl border flex flex-col overflow-hidden\",\r\n                    isToday\r\n                      ? \"bg-slate-900/80 border-purple-500/50 shadow-[0_0_30px_-10px_rgba(168,85,247,0.2)]\"\r\n                      : \"bg-slate-900/40 border-slate-800/50\"\r\n                  )}\r\n                >\r\n                  {/* Date Header */}\r\n                  <div className={cn(\r\n                    \"px-5 py-4 border-b flex items-center justify-between\",\r\n                    isToday ? \"bg-purple-500/10 border-purple-500/20\" : \"bg-slate-900/50 border-slate-800/50\"\r\n                  )}>\r\n                    <div>\r\n                      <div className={cn(\"text-lg font-bold\", isToday ? \"text-purple-300\" : \"text-slate-200\")}>\r\n                        {format(dateObj, 'd MMMM', { locale: tr })}\r\n                      </div>\r\n                      <div className={cn(\"text-xs font-medium uppercase tracking-wider\", isToday ? \"text-purple-400/70\" : \"text-slate-500\")}>\r\n                        {format(dateObj, 'EEEE', { locale: tr })}\r\n                      </div>\r\n                    </div>\r\n                    {isToday && (\r\n                      <span className=\"text-[10px] font-bold bg-purple-500 text-white px-2 py-0.5 rounded-full uppercase tracking-wider\">Bugün</span>\r\n                    )}\r\n                  </div>\r\n\r\n                  {/* List */}\r\n                  <div className=\"p-3 space-y-3 max-h-[500px] overflow-y-auto custom-scrollbar\">\r\n                    {items.map(lead => (\r\n                      <div key={lead.id} className=\"p-4 rounded-xl bg-slate-950/50 border border-slate-800/50 hover:border-slate-700/50 transition-colors group\">\r\n                        <div className=\"flex items-start justify-between mb-3\">\r\n                          <div>\r\n                            <div className=\"font-bold text-slate-200 text-base\">{lead.name}</div>\r\n                            <div className=\"flex items-center gap-1.5 text-xs text-slate-500 mt-0.5 font-medium\">\r\n                              <Phone size={12} />\r\n                              {lead.phone || '-'}\r\n                            </div>\r\n                          </div>\r\n                          {lead.price && (\r\n                            <div className=\"text-right\">\r\n                              <div className=\"text-sm font-bold text-slate-300 bg-slate-800/50 px-2 py-0.5 rounded-md font-mono\">\r\n                                {lead.price.toLocaleString('tr-TR')} ₺\r\n                              </div>\r\n                            </div>\r\n                          )}\r\n                        </div>\r\n\r\n                        <div className=\"flex items-center justify-between pt-3 border-t border-slate-800/50\">\r\n                          <div className=\"flex items-center gap-2\">\r\n                            <div className=\"p-1.5 bg-indigo-500/10 rounded-md\">\r\n                              <User size={14} className=\"text-indigo-400\" />\r\n                            </div>\r\n                            <span className=\"text-xs font-semibold text-slate-400\">\r\n                              {lead.process_name || 'İşlem Belirtilmemiş'}\r\n                            </span>\r\n                          </div>\r\n\r\n                          {lead.reservation_at && (\r\n                            <span className=\"text-xs font-bold text-slate-500 bg-slate-900 px-2 py-1 rounded\">\r\n                              {format(parseISO(lead.reservation_at), 'HH:mm')}\r\n                            </span>\r\n                          )}\r\n                        </div>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n              )\r\n            })}\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\deniz\\.gemini\\antigravity\\scratch\\oracle-crm\\app\\reminders\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\deniz\\.gemini\\antigravity\\scratch\\oracle-crm\\app\\reservations\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Phone' is defined but never used.","line":10,"column":31,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":36,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Phone"},"fix":{"range":[280,287],"text":""},"desc":"Remove unused variable \"Phone\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'X' is defined but never used.","line":11,"column":32,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":33,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"X"},"fix":{"range":[360,363],"text":""},"desc":"Remove unused variable \"X\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Sparkles' is defined but never used.","line":11,"column":35,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":43,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Sparkles"},"fix":{"range":[363,373],"text":""},"desc":"Remove unused variable \"Sparkles\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Pin' is defined but never used.","line":11,"column":45,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":48,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Pin"},"fix":{"range":[373,378],"text":""},"desc":"Remove unused variable \"Pin\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Clock' is defined but never used.","line":11,"column":50,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":55,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Clock"},"fix":{"range":[378,385],"text":""},"desc":"Remove unused variable \"Clock\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Archive' is defined but never used.","line":11,"column":57,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":64,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Archive"},"fix":{"range":[385,394],"text":""},"desc":"Remove unused variable \"Archive\"."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\"\r\n\r\nimport { useState, useEffect } from \"react\"\r\nimport { supabase } from \"@/lib/supabase\"\r\nimport { format, parseISO, isSameDay } from \"date-fns\"\r\nimport { tr } from \"date-fns/locale\"\r\nimport { cn } from \"@/lib/utils\"\r\n// Icons\r\nimport {\r\n    Calendar as CalendarIcon, Phone, User, ChevronRight, MessageCircle, Edit,\r\n    CalendarDays, Copy, Check, X, Sparkles, Pin, Clock, Archive\r\n} from \"lucide-react\"\r\n// UI Components\r\nimport { Button } from \"@/components/ui/button\"\r\nimport { Collapsible, CollapsibleContent, CollapsibleTrigger } from \"@/components/ui/collapsible\"\r\nimport { Popover, PopoverContent, PopoverTrigger } from \"@/components/ui/popover\"\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger, DialogFooter, DialogClose } from \"@/components/ui/dialog\"\r\nimport { Calendar } from \"@/components/ui/calendar\"\r\n\r\n// Types\r\ninterface Lead {\r\n    id: string\r\n    name: string\r\n    phone?: string\r\n    process_name?: string\r\n    price?: number\r\n    status: string\r\n    reservation_at?: string\r\n    ai_summary?: string\r\n}\r\n\r\ninterface GroupedReservations {\r\n    date: Date\r\n    leads: Lead[]\r\n}\r\n\r\n// Reuse Categories for Status Colors\r\nconst CATEGORIES: Record<string, { color: string, bg: string, border: string }> = {\r\n    'Rezervasyon': { color: 'text-blue-500', bg: 'bg-blue-500/10', border: 'border-blue-500/20' },\r\n    'Yeni': { color: 'text-green-500', bg: 'bg-green-500/10', border: 'border-green-500/20' },\r\n    'Sabit': { color: 'text-orange-500', bg: 'bg-orange-500/10', border: 'border-orange-500/20' },\r\n    'Takip': { color: 'text-cyan-500', bg: 'bg-cyan-500/10', border: 'border-cyan-500/20' },\r\n    'Arşiv': { color: 'text-slate-500', bg: 'bg-slate-500/10', border: 'border-slate-500/20' },\r\n}\r\n\r\nconst ORDERED_CATEGORIES = ['Rezervasyon', 'Yeni', 'Sabit', 'Takip', 'Arşiv']\r\n\r\nexport default function ReservationsPage() {\r\n    const [reservations, setReservations] = useState<GroupedReservations[]>([])\r\n    const [loading, setLoading] = useState(true)\r\n\r\n    // UI State\r\n    const [expanded, setExpanded] = useState<Record<string, boolean>>({})\r\n    const [copiedText, setCopiedText] = useState<string | null>(null)\r\n    const [reservationDate, setReservationDate] = useState<Date | undefined>(new Date())\r\n\r\n    useEffect(() => {\r\n        fetchReservations()\r\n    }, [])\r\n\r\n    const fetchReservations = async () => {\r\n        try {\r\n            setLoading(true)\r\n            const { data, error } = await supabase\r\n                .from('leads')\r\n                .select('*')\r\n                .or('reservation_at.not.is.null,status.eq.Rezervasyon')\r\n                .order('reservation_at', { ascending: true })\r\n\r\n            if (error) throw error\r\n\r\n            if (data) {\r\n                const grouped: GroupedReservations[] = []\r\n                const initialExpanded: Record<string, boolean> = {}\r\n\r\n                data.forEach((lead: Lead) => {\r\n                    const date = parseISO(lead.reservation_at!)\r\n                    const existingGroup = grouped.find(g => isSameDay(g.date, date))\r\n                    const dateKey = date.toISOString()\r\n\r\n                    if (existingGroup) {\r\n                        existingGroup.leads.push(lead)\r\n                        initialExpanded[dateKey] = true\r\n                    } else {\r\n                        grouped.push({ date, leads: [lead] })\r\n                        initialExpanded[dateKey] = true\r\n                    }\r\n                })\r\n\r\n                setReservations(grouped)\r\n                setExpanded(initialExpanded)\r\n            }\r\n        } catch (error) {\r\n            console.error('Error fetching reservations:', error)\r\n        } finally {\r\n            setLoading(false)\r\n        }\r\n    }\r\n\r\n    const toggleDate = (dateIso: string) => {\r\n        setExpanded(prev => ({ ...prev, [dateIso]: !prev[dateIso] }))\r\n    }\r\n\r\n    const handleCopy = (text: string) => {\r\n        navigator.clipboard.writeText(text)\r\n        setCopiedText(text)\r\n        setTimeout(() => setCopiedText(null), 2000)\r\n    }\r\n\r\n    const handleWhatsApp = (phone: string | null) => {\r\n        if (!phone) return\r\n        const cleanPhone = phone.replace(/\\D/g, '')\r\n        const finalPhone = cleanPhone.startsWith('90') ? cleanPhone : `90${cleanPhone}`\r\n        window.open(`https://web.whatsapp.com/send?phone=${finalPhone}`, '_blank')\r\n    }\r\n\r\n    const updateStatus = async (id: string, newStatus: string) => {\r\n        const updatedReservations = reservations.map(group => ({\r\n            ...group,\r\n            leads: group.leads.map(l => l.id === id ? { ...l, status: newStatus } : l)\r\n        }))\r\n        setReservations(updatedReservations)\r\n\r\n        await supabase.from('leads').update({ status: newStatus }).eq('id', id)\r\n    }\r\n\r\n    const handleReservation = async (leadId: string, date: Date | undefined) => {\r\n        if (!date) return\r\n        await supabase.from('leads').update({ reservation_at: date.toISOString() }).eq('id', leadId)\r\n        fetchReservations() // Refresh to move into correct date bucket\r\n    }\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"flex items-center justify-center h-screen text-slate-400\">\r\n                <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-500\"></div>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    return (\r\n        <div className=\"p-8 max-w-[1600px] mx-auto text-slate-200\">\r\n            <div className=\"mb-8 flex items-end justify-between border-b border-slate-800 pb-6\">\r\n                <div>\r\n                    <h1 className=\"text-3xl font-bold bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent\">\r\n                        Rezervasyon Takvimi\r\n                    </h1>\r\n                    <p className=\"text-slate-400 mt-2\">\r\n                        Tarihe göre planlanmış randevular (Liste Görünümü).\r\n                    </p>\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"space-y-6\">\r\n                {reservations.length === 0 ? (\r\n                    <div className=\"text-center py-20 bg-slate-900/30 rounded-2xl border border-slate-800/50 border-dashed\">\r\n                        <CalendarIcon size={48} className=\"mx-auto text-slate-600 mb-4\" />\r\n                        <h3 className=\"text-xl font-semibold text-slate-400\">Henüz Rezervasyon Yok</h3>\r\n                    </div>\r\n                ) : (\r\n                    reservations.map((group) => {\r\n                        const dateKey = group.date.toISOString()\r\n                        const isOpen = expanded[dateKey]\r\n\r\n                        return (\r\n                            <Collapsible\r\n                                key={dateKey}\r\n                                open={isOpen}\r\n                                onOpenChange={() => toggleDate(dateKey)}\r\n                                className={cn(\r\n                                    \"rounded-xl border transition-all duration-200\",\r\n                                    isOpen ? \"bg-slate-900/40 border-slate-800\" : \"bg-transparent border-transparent hover:bg-slate-900/20\"\r\n                                )}\r\n                            >\r\n                                <CollapsibleTrigger asChild>\r\n                                    <div className=\"flex items-center gap-3 p-4 cursor-pointer group select-none\">\r\n                                        <ChevronRight className={cn(\"text-slate-500 transition-transform duration-200\", isOpen && \"rotate-90\")} />\r\n\r\n                                        {/* Date Header */}\r\n                                        <div className=\"flex items-center gap-3 bg-purple-500/10 px-4 py-2 rounded-lg border border-purple-500/20\">\r\n                                            <CalendarIcon size={20} className=\"text-purple-400\" />\r\n                                            <span className=\"font-bold text-lg text-purple-100 capitalize\">\r\n                                                {format(group.date, 'd MMMM yyyy', { locale: tr })}\r\n                                            </span>\r\n                                            <span className=\"text-sm font-medium text-slate-500 ml-1 bg-slate-900/80 px-2 py-0.5 rounded-full\">\r\n                                                {format(group.date, 'EEEE', { locale: tr })}\r\n                                            </span>\r\n                                            <div className=\"h-4 w-px bg-purple-500/30 mx-1\" />\r\n                                            <span className=\"text-xs font-bold text-purple-300\">\r\n                                                {group.leads.length} Kayıt\r\n                                            </span>\r\n                                        </div>\r\n\r\n                                        <div className=\"flex-1 h-px bg-slate-800/50 ml-4 group-hover:bg-slate-800\" />\r\n                                    </div>\r\n                                </CollapsibleTrigger>\r\n\r\n                                <CollapsibleContent>\r\n                                    <div className=\"px-4 pb-4 space-y-1\">\r\n                                        {/* Wrapper for Headers + List */}\r\n\r\n                                        {/* Headers */}\r\n                                        <div className=\"flex items-center gap-4 px-6 py-2 border-b border-slate-800/50 mb-3 text-sm font-black text-slate-400 uppercase tracking-wide\">\r\n                                            <div className=\"w-[180px] shrink-0\">İsim & Telefon</div>\r\n                                            <div className=\"w-[160px] shrink-0\">İşlem & Ücret</div>\r\n                                            <div className=\"w-[150px] shrink-0\">Durum</div>\r\n                                            <div className=\"flex-1 pl-2\">Detay (AI)</div>\r\n                                        </div>\r\n\r\n                                        {/* List Items */}\r\n                                        {group.leads.map(lead => {\r\n                                            const config = CATEGORIES[lead.status] || { color: 'text-slate-500', bg: 'bg-slate-500/10', border: 'border-slate-500/20' }\r\n\r\n                                            return (\r\n                                                <div\r\n                                                    key={lead.id}\r\n                                                    className=\"flex items-center gap-4 px-6 py-2 rounded-lg hover:bg-slate-800/60 transition-all duration-200 hover:scale-[1.01] hover:shadow-md border border-transparent hover:border-slate-800/50 group bg-slate-900/20\"\r\n                                                >\r\n                                                    {/* Name & Phone */}\r\n                                                    <div className=\"w-[180px] shrink-0 flex flex-col justify-center gap-0.5\">\r\n                                                        <div className=\"text-[13px] font-bold text-slate-200 truncate leading-tight\">{lead.name}</div>\r\n                                                        <div className=\"text-[11px] font-semibold text-slate-500/90 truncate font-sans\">{lead.phone || '-'}</div>\r\n                                                    </div>\r\n\r\n                                                    {/* Process & Price */}\r\n                                                    <div className=\"w-[160px] shrink-0 flex flex-col justify-center gap-1\">\r\n                                                        <div className=\"flex items-center gap-2\">\r\n                                                            <div className={cn(\"w-2 h-2 rounded-full shrink-0 shadow-[0_0_8px]\",\r\n                                                                lead.process_name?.includes('Bağlama') ? \"bg-purple-500 shadow-purple-500/50\" :\r\n                                                                    lead.process_name?.includes('Geri') ? \"bg-cyan-500 shadow-cyan-500/50\" :\r\n                                                                        lead.process_name?.includes('Büyü') ? \"bg-red-500 shadow-red-500/50\" :\r\n                                                                            lead.process_name?.includes('Rızık') ? \"bg-amber-500 shadow-amber-500/50\" :\r\n                                                                                \"bg-slate-500 shadow-slate-500/50\"\r\n                                                            )} />\r\n                                                            <span className=\"text-[12px] font-bold text-slate-300 truncate opacity-90\">{lead.process_name || 'İşlem Yok'}</span>\r\n                                                        </div>\r\n                                                        <div className=\"text-[11px] font-bold text-slate-500 pl-4 opacity-80\">\r\n                                                            {lead.price ? `${lead.price.toLocaleString('tr-TR')} ₺` : '-'}\r\n                                                        </div>\r\n                                                    </div>\r\n\r\n                                                    {/* Status Selector */}\r\n                                                    <div className=\"w-[150px] shrink-0\">\r\n                                                        <Popover>\r\n                                                            <PopoverTrigger asChild>\r\n                                                                <button className={cn(\"text-[10px] font-black px-2.5 py-1 rounded-md border border-slate-800/50 hover:border-slate-700 hover:bg-slate-800 transition-all flex w-fit items-center gap-2 shadow-sm\", config.color, config.bg)}>\r\n                                                                    <div className={cn(\"w-1.5 h-1.5 rounded-full\", config.bg.replace('/10', ''))} />\r\n                                                                    {lead.status}\r\n                                                                </button>\r\n                                                            </PopoverTrigger>\r\n                                                            <PopoverContent className=\"w-48 p-1 bg-[#0F111A] border-slate-800 shadow-xl rounded-lg\">\r\n                                                                {ORDERED_CATEGORIES.map(cat => (\r\n                                                                    <button\r\n                                                                        key={cat}\r\n                                                                        onClick={() => updateStatus(lead.id, cat)}\r\n                                                                        className={cn(\r\n                                                                            \"w-full text-left px-3 py-2.5 text-xs rounded-md hover:bg-slate-800 flex items-center gap-2.5 transition-colors\",\r\n                                                                            cat === lead.status ? \"text-white bg-slate-800/80 font-bold\" : \"text-slate-400 font-semibold\"\r\n                                                                        )}\r\n                                                                    >\r\n                                                                        <div className={cn(\"w-2 h-2 rounded-full\", CATEGORIES[cat].bg.replace('/10', ''))} />\r\n                                                                        {cat}\r\n                                                                    </button>\r\n                                                                ))}\r\n                                                            </PopoverContent>\r\n                                                        </Popover>\r\n                                                    </div>\r\n\r\n                                                    {/* AI Summary (Detail) & Actions */}\r\n                                                    <div className=\"flex-1 min-w-0 flex items-center gap-6 pl-2\">\r\n                                                        <Dialog>\r\n                                                            <DialogTrigger asChild>\r\n                                                                <button className=\"text-[10px] font-semibold text-slate-500/80 hover:text-slate-300 transition-colors text-left truncate w-[260px] opacity-90 cursor-pointer\">\r\n                                                                    {lead.ai_summary || 'Detay yok...'}\r\n                                                                </button>\r\n                                                            </DialogTrigger>\r\n                                                            <DialogContent className=\"bg-slate-950 border-slate-800\">\r\n                                                                <DialogHeader>\r\n                                                                    <DialogTitle className=\"text-slate-100 flex items-center gap-2\">\r\n                                                                        <User size={18} className=\"text-slate-400\" />\r\n                                                                        {lead.name} - Detaylar\r\n                                                                    </DialogTitle>\r\n                                                                </DialogHeader>\r\n                                                                <div className=\"mt-4 p-4 bg-slate-900/50 rounded-lg border border-slate-800 text-slate-300 text-sm leading-relaxed max-h-[60vh] overflow-y-auto\">\r\n                                                                    {lead.ai_summary || \"Herhangi bir detay bulunamadı.\"}\r\n                                                                </div>\r\n                                                                <DialogFooter className=\"sm:justify-between gap-2 mt-4\">\r\n                                                                    <Button\r\n                                                                        variant=\"outline\"\r\n                                                                        size=\"sm\"\r\n                                                                        onClick={() => handleCopy(lead.ai_summary || \"\")}\r\n                                                                        className=\"gap-2 border-slate-700 hover:bg-slate-800 hover:text-white\"\r\n                                                                    >\r\n                                                                        {copiedText === lead.ai_summary ? <Check size={14} className=\"text-green-500\" /> : <Copy size={14} />}\r\n                                                                        {copiedText === lead.ai_summary ? \"Kopyalandı\" : \"Kopyala\"}\r\n                                                                    </Button>\r\n                                                                    <DialogClose asChild>\r\n                                                                        <Button variant=\"ghost\" size=\"sm\" className=\"text-slate-500 hover:text-white\">Kapat</Button>\r\n                                                                    </DialogClose>\r\n                                                                </DialogFooter>\r\n                                                            </DialogContent>\r\n                                                        </Dialog>\r\n\r\n                                                        {/* Actions - Persistent & Scaled */}\r\n                                                        <div className=\"flex gap-2 shrink-0 ml-auto\">\r\n                                                            <Popover>\r\n                                                                <PopoverTrigger asChild>\r\n                                                                    <Button variant=\"ghost\" size=\"icon\" className=\"h-10 w-10 text-blue-400 hover:text-blue-300 hover:bg-blue-500/10 rounded-xl transition-all hover:scale-110\" title=\"Randevu Oluştur\">\r\n                                                                        <CalendarDays size={22} />\r\n                                                                    </Button>\r\n                                                                </PopoverTrigger>\r\n                                                                <PopoverContent className=\"w-auto p-0 bg-slate-950 border-slate-800\" align=\"end\">\r\n                                                                    <Calendar\r\n                                                                        mode=\"single\"\r\n                                                                        selected={reservationDate}\r\n                                                                        onSelect={(date) => {\r\n                                                                            setReservationDate(date)\r\n                                                                            if (date) handleReservation(lead.id, date)\r\n                                                                        }}\r\n                                                                        locale={tr}\r\n                                                                        disabled={(date) => date < new Date(new Date().setHours(0, 0, 0, 0))}\r\n                                                                        initialFocus\r\n                                                                        className=\"p-3\"\r\n                                                                    />\r\n                                                                </PopoverContent>\r\n                                                            </Popover>\r\n\r\n                                                            <Button\r\n                                                                variant=\"ghost\"\r\n                                                                size=\"icon\"\r\n                                                                onClick={() => handleWhatsApp(lead.phone || null)}\r\n                                                                className=\"h-11 w-11 text-green-400 hover:text-green-300 hover:bg-green-500/10 rounded-xl transition-all hover:scale-110\"\r\n                                                                title=\"WhatsApp Web\"\r\n                                                            >\r\n                                                                <MessageCircle size={22} />\r\n                                                            </Button>\r\n                                                            <Button variant=\"ghost\" size=\"icon\" className=\"h-11 w-11 text-orange-400 hover:text-orange-300 hover:bg-orange-500/10 rounded-xl transition-all hover:scale-110\" title=\"Düzenle\">\r\n                                                                <Edit size={22} />\r\n                                                            </Button>\r\n                                                        </div>\r\n                                                    </div>\r\n                                                </div>\r\n                                            )\r\n                                        })}\r\n                                    </div>\r\n                                </CollapsibleContent>\r\n                            </Collapsible>\r\n                        )\r\n                    })\r\n                )}\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\deniz\\.gemini\\antigravity\\scratch\\oracle-crm\\app\\settings\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Layout' is defined but never used.","line":4,"column":63,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":69,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Layout"},"fix":{"range":[110,118],"text":""},"desc":"Remove unused variable \"Layout\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Textarea' is defined but never used.","line":7,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":18,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Textarea"},"fix":{"range":[249,300],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Switch' is defined but never used.","line":8,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":16,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Switch"},"fix":{"range":[302,349],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'TabsContent' is defined but never used.","line":17,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":27,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"TabsContent"},"fix":{"range":[542,555],"text":""},"desc":"Remove unused variable \"TabsContent\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Alert' is defined but never used.","line":19,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":15,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Alert"},"fix":{"range":[674,680],"text":""},"desc":"Remove unused variable \"Alert\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AlertDescription' is defined but never used.","line":19,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":33,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"AlertDescription"},"fix":{"range":[679,697],"text":""},"desc":"Remove unused variable \"AlertDescription\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AlertTitle' is defined but never used.","line":19,"column":35,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":45,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"AlertTitle"},"fix":{"range":[665,740],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'toast' is defined but never used.","line":22,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":15,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"toast"},"fix":{"range":[897,927],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'isLoading' is assigned a value but never used.","line":26,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":26,"endColumn":21},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'apiKey' is assigned a value but never used.","line":30,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":30,"endColumn":18},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setApiKey' is assigned a value but never used.","line":30,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":30,"endColumn":29},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'model' is assigned a value but never used.","line":31,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":31,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setModel' is assigned a value but never used.","line":31,"column":19,"nodeType":"Identifier","messageId":"unusedVar","endLine":31,"endColumn":27},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'prompt' is assigned a value but never used.","line":32,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":32,"endColumn":18},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setPrompt' is assigned a value but never used.","line":32,"column":20,"nodeType":"Identifier","messageId":"unusedVar","endLine":32,"endColumn":29},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'handleSaveGlobal' is assigned a value but never used.","line":34,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":34,"endColumn":27},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":139,"column":62,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":139,"endColumn":65,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8060,8063],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8060,8063],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`'` can be escaped with `&apos;`, `&lsquo;`, `&#39;`, `&rsquo;`.","line":179,"column":81,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&apos;"},"fix":{"range":[10612,10658],"text":"Zeyid Hoca&apos;nın beynini buradan yönetebilirsin."},"desc":"Replace with `&apos;`."},{"messageId":"replaceWithAlt","data":{"alt":"&lsquo;"},"fix":{"range":[10612,10658],"text":"Zeyid Hoca&lsquo;nın beynini buradan yönetebilirsin."},"desc":"Replace with `&lsquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#39;"},"fix":{"range":[10612,10658],"text":"Zeyid Hoca&#39;nın beynini buradan yönetebilirsin."},"desc":"Replace with `&#39;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rsquo;"},"fix":{"range":[10612,10658],"text":"Zeyid Hoca&rsquo;nın beynini buradan yönetebilirsin."},"desc":"Replace with `&rsquo;`."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":16,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\"\r\n\r\nimport { useState } from \"react\"\r\nimport { Settings, BrainCircuit, List, Save, Shield, Palette, Layout, RotateCcw } from \"lucide-react\"\r\nimport { Button } from \"@/components/ui/button\"\r\nimport { Input } from \"@/components/ui/input\"\r\nimport { Textarea } from \"@/components/ui/textarea\"\r\nimport { Switch } from \"@/components/ui/switch\"\r\nimport { Label } from \"@/components/ui/label\"\r\nimport {\r\n    Select,\r\n    SelectContent,\r\n    SelectItem,\r\n    SelectTrigger,\r\n    SelectValue,\r\n} from \"@/components/ui/select\"\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\"\r\nimport { Separator } from \"@/components/ui/separator\"\r\nimport { Alert, AlertDescription, AlertTitle } from \"@/components/ui/alert\"\r\nimport { ProcessTypesSettings } from \"@/components/settings/ProcessTypesSettings\"\r\nimport { useSettings } from \"@/components/providers/settings-provider\"\r\nimport { toast } from \"sonner\" // Assuming sonner is installed, or valid alt. If not, fallback to alert.\r\n\r\nexport default function SettingsPage() {\r\n    const { config, updateConfig, resetToDefaults } = useSettings()\r\n    const [isLoading, setIsLoading] = useState(false)\r\n    const [activeTab, setActiveTab] = useState(\"appearance\")\r\n\r\n    // Local state for AI (Mock)\r\n    const [apiKey, setApiKey] = useState(\"sk-or-...\")\r\n    const [model, setModel] = useState(\"openai/gpt-4o\")\r\n    const [prompt, setPrompt] = useState(\"\")\r\n\r\n    const handleSaveGlobal = async () => {\r\n        setIsLoading(true)\r\n        // Simulate delay\r\n        await new Promise(resolve => setTimeout(resolve, 800))\r\n        setIsLoading(false)\r\n        // Show success\r\n    }\r\n\r\n    return (\r\n        <div className=\"p-8 max-w-[1600px] mx-auto\">\r\n            <div className=\"flex items-center gap-3 mb-8 border-b border-slate-800 pb-6\">\r\n                <div className=\"p-2 bg-purple-500/10 rounded-lg\">\r\n                    <Settings className=\"text-purple-400\" size={28} />\r\n                </div>\r\n                <h1 className=\"text-3xl font-bold bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent\">\r\n                    Sistem Ayarları\r\n                </h1>\r\n            </div>\r\n\r\n            <div className=\"flex flex-col lg:flex-row gap-8\">\r\n                {/* Left Sidebar Menu */}\r\n                <div className=\"w-full lg:w-64 flex-shrink-0\">\r\n                    <Tabs defaultValue=\"appearance\" orientation=\"vertical\" value={activeTab} onValueChange={setActiveTab} className=\"w-full\">\r\n                        <TabsList className=\"flex flex-col h-auto bg-transparent gap-2 p-0 w-full items-stretch\">\r\n                            <TabsTrigger\r\n                                value=\"appearance\"\r\n                                className=\"justify-start gap-3 px-4 py-3 data-[state=active]:bg-purple-500/10 data-[state=active]:text-purple-400 data-[state=active]:border-l-2 data-[state=active]:border-purple-500 rounded-none rounded-r-lg transition-all\"\r\n                            >\r\n                                <Palette size={18} />\r\n                                Görünüm & Kimlik\r\n                            </TabsTrigger>\r\n                            <TabsTrigger\r\n                                value=\"ai\"\r\n                                className=\"justify-start gap-3 px-4 py-3 data-[state=active]:bg-purple-500/10 data-[state=active]:text-purple-400 data-[state=active]:border-l-2 data-[state=active]:border-purple-500 rounded-none rounded-r-lg transition-all\"\r\n                            >\r\n                                <BrainCircuit size={18} />\r\n                                Yapay Zeka\r\n                            </TabsTrigger>\r\n                            <TabsTrigger\r\n                                value=\"dictionaries\"\r\n                                className=\"justify-start gap-3 px-4 py-3 data-[state=active]:bg-purple-500/10 data-[state=active]:text-purple-400 data-[state=active]:border-l-2 data-[state=active]:border-purple-500 rounded-none rounded-r-lg transition-all\"\r\n                            >\r\n                                <List size={18} />\r\n                                İşlem Tanımları\r\n                            </TabsTrigger>\r\n                            <TabsTrigger\r\n                                value=\"security\"\r\n                                className=\"justify-start gap-3 px-4 py-3 data-[state=active]:bg-purple-500/10 data-[state=active]:text-purple-400 data-[state=active]:border-l-2 data-[state=active]:border-purple-500 rounded-none rounded-r-lg transition-all\"\r\n                            >\r\n                                <Shield size={18} />\r\n                                Güvenlik\r\n                            </TabsTrigger>\r\n                        </TabsList>\r\n                    </Tabs>\r\n                </div>\r\n\r\n                {/* Right Content Area */}\r\n                <div className=\"flex-1 bg-slate-900/50 border border-slate-800 rounded-xl p-8 min-h-[600px]\">\r\n\r\n                    {/* APPEARANCE TAB */}\r\n                    {activeTab === 'appearance' && (\r\n                        <div className=\"space-y-8 animate-in fade-in slide-in-from-right-4 duration-300\">\r\n                            <div>\r\n                                <h2 className=\"text-lg font-semibold text-purple-400 mb-1\">Görünüm ve Marka</h2>\r\n                                <p className=\"text-slate-400 text-sm\">Uygulamanın ismini, logosunu ve renk temasını buradan yönetebilirsiniz.</p>\r\n                            </div>\r\n                            <Separator className=\"bg-slate-800\" />\r\n\r\n                            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\r\n                                <div className=\"space-y-4\">\r\n                                    <Label className=\"text-slate-200\">Uygulama Başlığı (Sidebar)</Label>\r\n                                    <Input\r\n                                        value={config.sidebarTitle}\r\n                                        onChange={(e) => updateConfig({ sidebarTitle: e.target.value })}\r\n                                        className=\"bg-slate-950 border-slate-700\"\r\n                                        placeholder=\"Örn: Oracle CRM\"\r\n                                    />\r\n                                    <p className=\"text-xs text-slate-500\">Sol menünün en üstünde görünen marka ismi.</p>\r\n                                </div>\r\n\r\n                                <div className=\"space-y-4\">\r\n                                    <Label className=\"text-slate-200\">Tarayıcı Başlığı (Tab Title)</Label>\r\n                                    <Input\r\n                                        value={config.appName}\r\n                                        onChange={(e) => updateConfig({ appName: e.target.value })}\r\n                                        className=\"bg-slate-950 border-slate-700\"\r\n                                        placeholder=\"Oracle CRM\"\r\n                                    />\r\n                                </div>\r\n\r\n                                <div className=\"space-y-4\">\r\n                                    <Label className=\"text-slate-200\">Logo URL</Label>\r\n                                    <Input\r\n                                        value={config.logoUrl || ''}\r\n                                        onChange={(e) => updateConfig({ logoUrl: e.target.value })}\r\n                                        className=\"bg-slate-950 border-slate-700\"\r\n                                        placeholder=\"https://...\"\r\n                                    />\r\n                                    <p className=\"text-xs text-slate-500\">Logonuzun doğrudan resim bağlantısını yapıştırın.</p>\r\n                                </div>\r\n\r\n                                <div className=\"space-y-4\">\r\n                                    <Label className=\"text-slate-200\">Renk Teması</Label>\r\n                                    <Select\r\n                                        value={config.theme}\r\n                                        onValueChange={(val: any) => updateConfig({ theme: val })}\r\n                                    >\r\n                                        <SelectTrigger className=\"bg-slate-950 border-slate-700\">\r\n                                            <SelectValue />\r\n                                        </SelectTrigger>\r\n                                        <SelectContent className=\"bg-slate-900 border-slate-800\">\r\n                                            <SelectItem value=\"modern-purple\">🔮 Modern Mor (Varsayılan)</SelectItem>\r\n                                            <SelectItem value=\"ocean-blue\">🌊 Okyanus Mavisi</SelectItem>\r\n                                            <SelectItem value=\"forest-green\">🌲 Orman Yeşili</SelectItem>\r\n                                            <SelectItem value=\"sunset-orange\">🌅 Gün Batımı</SelectItem>\r\n                                        </SelectContent>\r\n                                    </Select>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <Separator className=\"bg-slate-800\" />\r\n\r\n                            <div className=\"flex justify-between items-center\">\r\n                                <Button\r\n                                    variant=\"destructive\"\r\n                                    className=\"bg-red-500/10 text-red-400 hover:bg-red-500/20 border border-red-500/20\"\r\n                                    onClick={resetToDefaults}\r\n                                >\r\n                                    <RotateCcw className=\"mr-2\" size={16} />\r\n                                    Varsayılana Dön\r\n                                </Button>\r\n                                {/* Changes are auto-saved in context, but we can allow explicit save for UX */}\r\n                                <Button className=\"bg-green-600 hover:bg-green-700 text-white\">\r\n                                    <Save className=\"mr-2\" size={18} />\r\n                                    Ayarları Kaydet\r\n                                </Button>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* AI Tab */}\r\n                    {activeTab === 'ai' && (\r\n                        <div className=\"space-y-8 animate-in fade-in slide-in-from-right-4 duration-300\">\r\n                            <div>\r\n                                <h2 className=\"text-lg font-semibold text-purple-400 mb-1\">Yapay Zeka Konfigürasyonu</h2>\r\n                                <p className=\"text-slate-400 text-sm\">Zeyid Hoca'nın beynini buradan yönetebilirsin.</p>\r\n                            </div>\r\n                            <Separator className=\"bg-slate-800\" />\r\n                            {/* ... existing AI settings ... */}\r\n                            <p className=\"text-slate-500 text-sm\">Bu modül yapım aşamasındadır.</p>\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* Dictionaries Tab */}\r\n                    {activeTab === 'dictionaries' && (\r\n                        <ProcessTypesSettings />\r\n                    )}\r\n\r\n                    {/* Security Tab */}\r\n                    {activeTab === 'security' && (\r\n                        <div className=\"flex flex-col items-center justify-center h-full text-slate-500 animate-in fade-in slide-in-from-right-4\">\r\n                            <Shield size={48} className=\"mb-4 opacity-50\" />\r\n                            <p className=\"text-lg font-medium\">Bu özellik yapım aşamasında</p>\r\n                            <p className=\"text-sm\">Passkey ve Şifre yönetimi.</p>\r\n                        </div>\r\n                    )}\r\n\r\n                </div>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\deniz\\.gemini\\antigravity\\scratch\\oracle-crm\\components\\JsonImportDialog.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":81,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":81,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2734,2737],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2734,2737],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\n'use client'\r\n\r\nimport { useState } from \"react\"\r\nimport { Upload, FileJson, CheckCircle, AlertCircle } from \"lucide-react\"\r\nimport { Button } from \"@/components/ui/button\"\r\nimport {\r\n    Dialog,\r\n    DialogContent,\r\n    DialogDescription,\r\n    DialogHeader,\r\n    DialogTitle,\r\n    DialogTrigger,\r\n} from \"@/components/ui/dialog\"\r\nimport { supabase } from \"@/lib/supabase\"\r\n\r\ninterface JsonImportDialogProps {\r\n    onSuccess?: () => void\r\n}\r\n\r\nexport function JsonImportDialog({ onSuccess }: JsonImportDialogProps) {\r\n    const [isOpen, setIsOpen] = useState(false)\r\n    const [isLoading, setIsLoading] = useState(false)\r\n    const [error, setError] = useState<string | null>(null)\r\n    const [success, setSuccess] = useState<string | null>(null)\r\n\r\n    const handleFileUpload = async (event: React.ChangeEvent<HTMLInputElement>) => {\r\n        const file = event.target.files?.[0]\r\n        if (!file) return\r\n\r\n        setIsLoading(true)\r\n        setError(null)\r\n        setSuccess(null)\r\n\r\n        try {\r\n            const text = await file.text()\r\n            const json = JSON.parse(text)\r\n\r\n            // Perform Mapping (Flutter logic replication)\r\n            const leadData = {\r\n                name: json['isim_soyisim'] || 'Bilinmeyen',\r\n                phone: json['telefon'] || '',\r\n                source: 'JSON Import',\r\n                process_name: json['islem'] || 'Bilinmeyen',\r\n                status: 'Yeni', // Default status from Flutter app\r\n                price: json['ucret'] ? parseFloat(json['ucret']) : null,\r\n                ai_summary: json['detay'] || null,\r\n                created_at: json['sistem']?.['olusturulma_tarihi'] || new Date().toISOString(),\r\n            }\r\n\r\n            // Check configuration\r\n            if (!('auth' in supabase)) {\r\n                // Mock success\r\n                setSuccess(`[DEMO] ✅ ${leadData.name} başarıyla eklendi! (Veritabanı bağlı değil)`)\r\n                if (onSuccess) onSuccess()\r\n                setTimeout(() => {\r\n                    setIsOpen(false)\r\n                    setSuccess(null)\r\n                }, 2000)\r\n                setIsLoading(false)\r\n                event.target.value = ''\r\n                return\r\n            }\r\n\r\n            // Insert into Supabase\r\n            const { error: dbError } = await supabase\r\n                .from('leads')\r\n                .insert([leadData])\r\n\r\n            if (dbError) throw dbError\r\n\r\n            setSuccess(`✅ ${leadData.name} başarıyla eklendi!`)\r\n            if (onSuccess) onSuccess()\r\n\r\n            // Close dialog after 2 seconds on success\r\n            setTimeout(() => {\r\n                setIsOpen(false)\r\n                setSuccess(null)\r\n            }, 2000)\r\n\r\n        } catch (err: any) {\r\n            console.error(err)\r\n\r\n            let errorMessage = err.message || \"Bilinmeyen bir hata oluştu\"\r\n\r\n            // Check for missing table error\r\n            if (errorMessage.includes(\"Could not find the table\") || errorMessage.includes(\"relation\") && errorMessage.includes(\"does not exist\")) {\r\n                errorMessage = \"Veritabanı tabloları bulunamadı! Lütfen Supabase SQL Editor'e giderek size verdiğim 'supabase_schema.sql' kodlarını çalıştırın.\"\r\n            }\r\n\r\n            setError(errorMessage)\r\n        } finally {\r\n            setIsLoading(false)\r\n            // Reset input\r\n            event.target.value = ''\r\n        }\r\n    }\r\n\r\n    return (\r\n        <Dialog open={isOpen} onOpenChange={setIsOpen}>\r\n            <DialogTrigger asChild>\r\n                <Button className=\"bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white gap-2 border-0 shadow-lg shadow-purple-900/20 transition-all duration-300 hover:scale-[1.02]\">\r\n                    <Upload size={18} />\r\n                    JSON Yükle\r\n                </Button>\r\n            </DialogTrigger>\r\n            <DialogContent className=\"sm:max-w-[425px] bg-slate-900 border-slate-800 text-slate-100\">\r\n                <DialogHeader>\r\n                    <DialogTitle>JSON Müşteri Kaydı Yükle</DialogTitle>\r\n                    <DialogDescription className=\"text-slate-400\">\r\n                        Müşteri verilerini içeren .json dosyasını seçin.\r\n                    </DialogDescription>\r\n                </DialogHeader>\r\n\r\n                <div className=\"flex flex-col items-center gap-6 py-4\">\r\n                    {!isLoading && !success && !error && (\r\n                        <label className=\"flex flex-col items-center justify-center w-full h-32 border-2 border-dashed border-slate-700 rounded-lg cursor-pointer hover:bg-slate-800/50 transition-colors\">\r\n                            <div className=\"flex flex-col items-center justify-center pt-5 pb-6\">\r\n                                <FileJson className=\"w-8 h-8 mb-2 text-slate-400\" />\r\n                                <p className=\"mb-2 text-sm text-slate-400\">\r\n                                    <span className=\"font-semibold\">Yüklemek için tıklayın</span>\r\n                                </p>\r\n                                <p className=\"text-xs text-slate-500\">.json dosyaları</p>\r\n                            </div>\r\n                            <input\r\n                                type=\"file\"\r\n                                accept=\".json\"\r\n                                className=\"hidden\"\r\n                                onChange={handleFileUpload}\r\n                            />\r\n                        </label>\r\n                    )}\r\n\r\n                    {isLoading && (\r\n                        <div className=\"flex flex-col items-center gap-2\">\r\n                            <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-500\"></div>\r\n                            <p className=\"text-sm text-slate-400\">Yükleniyor...</p>\r\n                        </div>\r\n                    )}\r\n\r\n                    {success && (\r\n                        <div className=\"flex flex-col items-center gap-2 text-green-400 bg-green-500/10 p-4 rounded-lg w-full\">\r\n                            <CheckCircle size={24} />\r\n                            <p className=\"text-sm font-medium\">{success}</p>\r\n                        </div>\r\n                    )}\r\n\r\n                    {error && (\r\n                        <div className=\"flex flex-col items-center gap-2 text-red-400 bg-red-500/10 p-4 rounded-lg w-full text-center\">\r\n                            <AlertCircle size={24} />\r\n                            <p className=\"text-sm font-medium\">{error}</p>\r\n                            <Button\r\n                                variant=\"outline\"\r\n                                size=\"sm\"\r\n                                onClick={() => setError(null)}\r\n                                className=\"mt-2 border-red-500/30 hover:bg-red-500/20 text-red-300\"\r\n                            >\r\n                                Tekrar Dene\r\n                            </Button>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </DialogContent>\r\n        </Dialog>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\deniz\\.gemini\\antigravity\\scratch\\oracle-crm\\components\\KPICard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\deniz\\.gemini\\antigravity\\scratch\\oracle-crm\\components\\Sidebar.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'clsx' is defined but never used.","line":7,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":14,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"clsx"},"fix":{"range":[190,217],"text":""},"desc":"Remove unused import declaration."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\n'use client'\r\n\r\nimport Link from 'next/link'\r\nimport { usePathname } from 'next/navigation'\r\nimport { LayoutDashboard, Users, Bell, BrainCircuit, Settings, Calendar } from 'lucide-react'\r\nimport { clsx } from 'clsx'\r\nimport { twMerge } from 'tailwind-merge'\r\nimport { useSettings } from '@/components/providers/settings-provider'\r\n\r\nexport function Sidebar() {\r\n    const pathname = usePathname()\r\n    const { config } = useSettings()\r\n\r\n    const items = [\r\n        { label: 'Ana Sayfa', icon: LayoutDashboard, path: '/' },\r\n        { label: 'Rezervasyonlar', icon: Calendar, path: '/reservations' },\r\n        { label: 'Kayıtlar', icon: Users, path: '/leads' },\r\n        { label: 'Hatırlatmalar', icon: Bell, path: '/reminders' },\r\n        { label: 'Bakım Yap', icon: BrainCircuit, path: '/analysis' },\r\n        { label: 'Ayarlar', icon: Settings, path: '/settings' },\r\n    ]\r\n\r\n    return (\r\n        <div className=\"w-[240px] h-screen bg-slate-900/50 border-r border-slate-700 p-5 flex flex-col text-slate-100\">\r\n            <div className=\"mb-6 px-3\">\r\n                <h1 className=\"text-xl font-bold bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent truncate\" title={config.sidebarTitle}>\r\n                    {config.sidebarTitle}\r\n                </h1>\r\n            </div>\r\n\r\n            <div className=\"flex flex-col gap-2\">\r\n                {items.map((item) => {\r\n                    const isActive = pathname === item.path || (item.path !== '/' && pathname.startsWith(item.path))\r\n\r\n                    return (\r\n                        <Link\r\n                            key={item.path}\r\n                            href={item.path}\r\n                            className={twMerge(\r\n                                \"flex items-center gap-3 px-3 py-2.5 rounded-lg transition-all duration-200 border border-transparent\",\r\n                                \"hover:bg-purple-500/10 hover:border-purple-500/20\",\r\n                                isActive && \"bg-purple-500/20 border-purple-500 text-white shadow-sm shadow-purple-500/10\"\r\n                            )}\r\n                        >\r\n                            <item.icon size={20} className={isActive ? \"text-purple-400\" : \"text-slate-400\"} />\r\n                            <span className={isActive ? \"text-purple-100 font-medium\" : \"text-slate-400\"}>\r\n                                {item.label}\r\n                            </span>\r\n                        </Link>\r\n                    )\r\n                })}\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\deniz\\.gemini\\antigravity\\scratch\\oracle-crm\\components\\providers\\settings-provider.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is assigned a value but never used.","line":50,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":50,"endColumn":32}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\"\r\n\r\nimport React, { createContext, useContext, useEffect, useState } from \"react\"\r\nimport { supabase } from \"@/lib/supabase\"\r\n\r\ninterface UIConfig {\r\n    theme: 'modern-purple' | 'ocean-blue' | 'forest-green' | 'sunset-orange'\r\n    appName: string\r\n    sidebarTitle: string\r\n    logoUrl: string | null\r\n    isSidebarCollapsed: boolean\r\n}\r\n\r\nconst DEFAULT_CONFIG: UIConfig = {\r\n    theme: 'modern-purple',\r\n    appName: 'Oracle CRM',\r\n    sidebarTitle: 'Rezervasyon CRM',\r\n    logoUrl: null,\r\n    isSidebarCollapsed: false\r\n}\r\n\r\ninterface SettingsContextType {\r\n    config: UIConfig\r\n    isLoading: boolean\r\n    updateConfig: (updates: Partial<UIConfig>) => Promise<void>\r\n    resetToDefaults: () => Promise<void>\r\n}\r\n\r\nconst SettingsContext = createContext<SettingsContextType | undefined>(undefined)\r\n\r\nexport function SettingsProvider({ children }: { children: React.ReactNode }) {\r\n    const [config, setConfig] = useState<UIConfig>(DEFAULT_CONFIG)\r\n    const [isLoading, setIsLoading] = useState(true)\r\n\r\n    useEffect(() => {\r\n        fetchSettings()\r\n    }, [])\r\n\r\n    const fetchSettings = async () => {\r\n        setIsLoading(true)\r\n        if (!('auth' in supabase)) {\r\n            // Mock mode\r\n            const saved = localStorage.getItem('ui_config')\r\n            if (saved) setConfig(JSON.parse(saved))\r\n            setIsLoading(false)\r\n            return\r\n        }\r\n\r\n        try {\r\n            const { data, error } = await supabase\r\n                .from('settings')\r\n                .select('ui_config')\r\n                .single()\r\n\r\n            if (data?.ui_config) {\r\n                setConfig({ ...DEFAULT_CONFIG, ...data.ui_config })\r\n            }\r\n        } catch (error) {\r\n            console.error('Error fetching settings:', error)\r\n        } finally {\r\n            setIsLoading(false)\r\n        }\r\n    }\r\n\r\n    const updateConfig = async (updates: Partial<UIConfig>) => {\r\n        const newConfig = { ...config, ...updates }\r\n        setConfig(newConfig) // Optimistic update\r\n\r\n        if (!('auth' in supabase)) {\r\n            localStorage.setItem('ui_config', JSON.stringify(newConfig))\r\n            return\r\n        }\r\n\r\n        try {\r\n            // First check if row exists, if not insert\r\n            const { count } = await supabase.from('settings').select('*', { count: 'exact', head: true })\r\n\r\n            if (count === 0) {\r\n                await supabase.from('settings').insert([{ ui_config: newConfig }])\r\n            } else {\r\n                // Assuming single row for global settings\r\n                // For multi-user, we'd use user_id, but here it's global app config as requested\r\n                await supabase\r\n                    .from('settings')\r\n                    .update({ ui_config: newConfig })\r\n                    .not('id', 'is', null) // Update all/first row\r\n            }\r\n        } catch (error) {\r\n            console.error('Error saving settings:', error)\r\n            // Revert on error could go here\r\n        }\r\n    }\r\n\r\n    const resetToDefaults = async () => {\r\n        setConfig(DEFAULT_CONFIG)\r\n        if ('auth' in supabase) {\r\n            await supabase\r\n                .from('settings')\r\n                .update({ ui_config: DEFAULT_CONFIG })\r\n                .not('id', 'is', null)\r\n        } else {\r\n            localStorage.removeItem('ui_config')\r\n        }\r\n    }\r\n\r\n    return (\r\n        <SettingsContext.Provider value={{ config, isLoading, updateConfig, resetToDefaults }}>\r\n            {children}\r\n        </SettingsContext.Provider>\r\n    )\r\n}\r\n\r\nexport const useSettings = () => {\r\n    const context = useContext(SettingsContext)\r\n    if (context === undefined) {\r\n        throw new Error(\"useSettings must be used within a SettingsProvider\")\r\n    }\r\n    return context\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\deniz\\.gemini\\antigravity\\scratch\\oracle-crm\\components\\settings\\ProcessTypesSettings.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Check' is defined but never used.","line":5,"column":45,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":50,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Check"},"fix":{"range":[105,112],"text":""},"desc":"Remove unused variable \"Check\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Palette' is defined but never used.","line":5,"column":52,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":59,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Palette"},"fix":{"range":[112,121],"text":""},"desc":"Remove unused variable \"Palette\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Select' is defined but never used.","line":19,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":11,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Select"},"fix":{"range":[528,535],"text":""},"desc":"Remove unused variable \"Select\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'SelectContent' is defined but never used.","line":20,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":18,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"SelectContent"},"fix":{"range":[534,554],"text":""},"desc":"Remove unused variable \"SelectContent\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'SelectItem' is defined but never used.","line":21,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":15,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"SelectItem"},"fix":{"range":[554,571],"text":""},"desc":"Remove unused variable \"SelectItem\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'SelectTrigger' is defined but never used.","line":22,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":18,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"SelectTrigger"},"fix":{"range":[571,591],"text":""},"desc":"Remove unused variable \"SelectTrigger\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'SelectValue' is defined but never used.","line":23,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":16,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"SelectValue"},"fix":{"range":[514,643],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`fetchItems` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\nC:\\Users\\deniz\\.gemini\\antigravity\\scratch\\oracle-crm\\components\\settings\\ProcessTypesSettings.tsx:59:9\n  57 |\n  58 |     useEffect(() => {\n> 59 |         fetchItems()\n     |         ^^^^^^^^^^ `fetchItems` accessed before it is declared\n  60 |     }, [])\n  61 |\n  62 |     const fetchItems = async () => {\n\nC:\\Users\\deniz\\.gemini\\antigravity\\scratch\\oracle-crm\\components\\settings\\ProcessTypesSettings.tsx:62:5\n  60 |     }, [])\n  61 |\n> 62 |     const fetchItems = async () => {\n     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 63 |         setLoading(true)\n     | ^^^^^^^^^^^^^^^^^^^^^^^^\n> 64 |         const { data, error } = await supabase\n     …\n     | ^^^^^^^^^^^^^^^^^^^^^^^^\n> 79 |         setLoading(false)\n     | ^^^^^^^^^^^^^^^^^^^^^^^^\n> 80 |     }\n     | ^^^^^^ `fetchItems` is declared here\n  81 |\n  82 |     const handleOpenDialog = (item?: ProcessType) => {\n  83 |         if (item) {","line":59,"column":9,"nodeType":null,"endLine":59,"endColumn":19},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":112,"column":78,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":112,"endColumn":81,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3546,3549],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3546,3549],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":141,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":141,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4743,4746],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4743,4746],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":206,"column":68,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":206,"endColumn":71,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8685,8688],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8685,8688],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\n'use client'\r\n\r\nimport { useState, useEffect } from \"react\"\r\nimport { Plus, Edit2, Trash2, GripVertical, Check, Palette, DollarSign } from \"lucide-react\"\r\nimport * as Icons from \"lucide-react\"\r\nimport { supabase } from \"@/lib/supabase\"\r\nimport { Button } from \"@/components/ui/button\"\r\nimport { Input } from \"@/components/ui/input\"\r\nimport { Label } from \"@/components/ui/label\"\r\nimport {\r\n    Dialog,\r\n    DialogContent,\r\n    DialogHeader,\r\n    DialogTitle,\r\n    DialogFooter,\r\n} from \"@/components/ui/dialog\"\r\nimport {\r\n    Select,\r\n    SelectContent,\r\n    SelectItem,\r\n    SelectTrigger,\r\n    SelectValue,\r\n} from \"@/components/ui/select\"\r\nimport { ScrollArea } from \"@/components/ui/scroll-area\"\r\n\r\n// Types\r\ninterface ProcessType {\r\n    id: string\r\n    name: string\r\n    default_fee: number\r\n    icon: string\r\n    color: string\r\n}\r\n\r\nconst AVAILABLE_ICONS = [\r\n    'Scissors', 'Brush', 'SprayCan', 'Sparkles', 'Ghost', 'Gem', 'Crown',\r\n    'Zap', 'Heart', 'Star', 'Moon', 'Sun'\r\n]\r\n\r\nconst AVAILABLE_COLORS = [\r\n    '#7C3AED', '#2563EB', '#DB2777', '#DC2626', '#EA580C',\r\n    '#D97706', '#65A30D', '#059669', '#0891B2', '#475569'\r\n]\r\n\r\nexport function ProcessTypesSettings() {\r\n    const [items, setItems] = useState<ProcessType[]>([])\r\n    const [loading, setLoading] = useState(true)\r\n    const [dialogOpen, setDialogOpen] = useState(false)\r\n    const [editingItem, setEditingItem] = useState<ProcessType | null>(null)\r\n\r\n    // Form State\r\n    const [name, setName] = useState(\"\")\r\n    const [fee, setFee] = useState(\"0\")\r\n    const [selectedIcon, setSelectedIcon] = useState(\"Sparkles\")\r\n    const [selectedColor, setSelectedColor] = useState(AVAILABLE_COLORS[0])\r\n\r\n    useEffect(() => {\r\n        fetchItems()\r\n    }, [])\r\n\r\n    const fetchItems = async () => {\r\n        setLoading(true)\r\n        const { data, error } = await supabase\r\n            .from('process_types')\r\n            .select('*')\r\n            .order('created_at', { ascending: true }) // In real app, order by rank\r\n\r\n        if (!error && data) {\r\n            setItems(data)\r\n        } else {\r\n            // Mock Data if Supabase is empty or unconnected\r\n            setItems([\r\n                { id: '1', name: 'Bağlama', default_fee: 3500, icon: 'Link', color: '#7C3AED' },\r\n                { id: '2', name: 'Geri Getirme', default_fee: 4200, icon: 'Undo2', color: '#22D3EE' },\r\n                { id: '3', name: 'Rızık Açma', default_fee: 2800, icon: 'Sun', color: '#F59E0B' },\r\n            ])\r\n        }\r\n        setLoading(false)\r\n    }\r\n\r\n    const handleOpenDialog = (item?: ProcessType) => {\r\n        if (item) {\r\n            setEditingItem(item)\r\n            setName(item.name)\r\n            setFee(item.default_fee.toString())\r\n            setSelectedIcon(item.icon)\r\n            setSelectedColor(item.color)\r\n        } else {\r\n            setEditingItem(null)\r\n            setName(\"\")\r\n            setFee(\"0\")\r\n            setSelectedIcon(\"Sparkles\")\r\n            setSelectedColor(AVAILABLE_COLORS[0])\r\n        }\r\n        setDialogOpen(true)\r\n    }\r\n\r\n    const handleSave = async () => {\r\n        const newItem = {\r\n            name,\r\n            default_fee: parseInt(fee) || 0,\r\n            icon: selectedIcon,\r\n            color: selectedColor\r\n        }\r\n\r\n        if (editingItem) {\r\n            // Update (Mocked for now)\r\n            setItems(items.map(i => i.id === editingItem.id ? { ...i, ...newItem } : i))\r\n        } else {\r\n            // Create (Mocked for now)\r\n            setItems([...items, { id: Date.now().toString(), ...newItem } as any])\r\n        }\r\n        setDialogOpen(false)\r\n    }\r\n\r\n    const handleDelete = (id: string) => {\r\n        if (confirm('Bu işlemi silmek istediğinize emin misiniz?')) {\r\n            setItems(items.filter(i => i.id !== id))\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div className=\"space-y-6 animate-in fade-in slide-in-from-right-4 duration-300\">\r\n            <div className=\"flex items-center justify-between\">\r\n                <div>\r\n                    <h2 className=\"text-lg font-semibold text-purple-400 mb-1\">İşlem Tipleri</h2>\r\n                    <p className=\"text-slate-400 text-sm\">Sunduğunuz hizmetleri buradan yönetebilirsiniz.</p>\r\n                </div>\r\n                <Button onClick={() => handleOpenDialog()} className=\"bg-purple-600 hover:bg-purple-700 text-white gap-2\">\r\n                    <Plus size={18} />\r\n                    Yeni İşlem\r\n                </Button>\r\n            </div>\r\n\r\n            <div className=\"space-y-3\">\r\n                {loading ? (\r\n                    <p className=\"text-slate-500 text-center py-8\">Yükleniyor...</p>\r\n                ) : (\r\n                    items.map((item) => {\r\n                        const IconComponent = (Icons as any)[item.icon] || Icons.HelpCircle\r\n                        return (\r\n                            <div key={item.id} className=\"flex items-center gap-4 p-4 bg-slate-950/50 border border-slate-800 rounded-xl group hover:border-purple-500/30 transition-all\">\r\n                                <GripVertical className=\"text-slate-600 cursor-grab opacity-0 group-hover:opacity-100 transition-opacity\" size={20} />\r\n\r\n                                <div\r\n                                    className=\"w-10 h-10 rounded-lg flex items-center justify-center border-2\"\r\n                                    style={{\r\n                                        backgroundColor: `${item.color}20`,\r\n                                        borderColor: item.color,\r\n                                        color: item.color\r\n                                    }}\r\n                                >\r\n                                    <IconComponent size={20} />\r\n                                </div>\r\n\r\n                                <div className=\"flex-1\">\r\n                                    <h3 className=\"font-semibold text-slate-200\">{item.name}</h3>\r\n                                    <p className=\"text-sm text-slate-500\">Varsayılan: {item.default_fee} ₺</p>\r\n                                </div>\r\n\r\n                                <div className=\"flex items-center gap-1 opacity-60 group-hover:opacity-100 transition-opacity\">\r\n                                    <Button variant=\"ghost\" size=\"icon\" onClick={() => handleOpenDialog(item)} className=\"hover:text-purple-400\">\r\n                                        <Edit2 size={16} />\r\n                                    </Button>\r\n                                    <Button variant=\"ghost\" size=\"icon\" onClick={() => handleDelete(item.id)} className=\"hover:text-red-400\">\r\n                                        <Trash2 size={16} />\r\n                                    </Button>\r\n                                </div>\r\n                            </div>\r\n                        )\r\n                    })\r\n                )}\r\n            </div>\r\n\r\n            <Dialog open={dialogOpen} onOpenChange={setDialogOpen}>\r\n                <DialogContent className=\"bg-slate-900 border-slate-800 text-slate-100 sm:max-w-[425px]\">\r\n                    <DialogHeader>\r\n                        <DialogTitle>{editingItem ? 'İşlemi Düzenle' : 'Yeni İşlem Ekle'}</DialogTitle>\r\n                    </DialogHeader>\r\n\r\n                    <div className=\"space-y-4 py-4\">\r\n                        <div className=\"space-y-2\">\r\n                            <Label>İşlem Adı</Label>\r\n                            <Input value={name} onChange={e => setName(e.target.value)} className=\"bg-slate-950 border-slate-700\" placeholder=\"Örn: Bağlama Büyüsü\" />\r\n                        </div>\r\n\r\n                        <div className=\"space-y-2\">\r\n                            <Label>Varsayılan Ücret (₺)</Label>\r\n                            <div className=\"relative\">\r\n                                <DollarSign className=\"absolute left-3 top-2.5 text-slate-500\" size={16} />\r\n                                <Input\r\n                                    type=\"number\"\r\n                                    value={fee}\r\n                                    onChange={e => setFee(e.target.value)}\r\n                                    className=\"bg-slate-950 border-slate-700 pl-9\"\r\n                                />\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className=\"space-y-2\">\r\n                            <Label>İkon</Label>\r\n                            <ScrollArea className=\"h-[120px] rounded-md border border-slate-800 bg-slate-950 p-4\">\r\n                                <div className=\"flex flex-wrap gap-2\">\r\n                                    {AVAILABLE_ICONS.map(icon => {\r\n                                        const IconComp = (Icons as any)[icon] || Icons.HelpCircle\r\n                                        const isSelected = selectedIcon === icon\r\n                                        return (\r\n                                            <button\r\n                                                key={icon}\r\n                                                onClick={() => setSelectedIcon(icon)}\r\n                                                className={`p-2 rounded-lg border transition-all ${isSelected ? 'bg-purple-500/20 border-purple-500 text-purple-400' : 'border-transparent text-slate-400 hover:bg-slate-900 hover:text-slate-200'}`}\r\n                                            >\r\n                                                <IconComp size={20} />\r\n                                            </button>\r\n                                        )\r\n                                    })}\r\n                                </div>\r\n                            </ScrollArea>\r\n                        </div>\r\n\r\n                        <div className=\"space-y-2\">\r\n                            <Label>Renk Etiketi</Label>\r\n                            <div className=\"flex flex-wrap gap-3\">\r\n                                {AVAILABLE_COLORS.map(color => (\r\n                                    <button\r\n                                        key={color}\r\n                                        onClick={() => setSelectedColor(color)}\r\n                                        className={`w-8 h-8 rounded-full border-2 transition-all ${selectedColor === color ? 'border-white scale-110 shadow-lg shadow-white/10' : 'border-transparent opacity-70 hover:opacity-100'}`}\r\n                                        style={{ backgroundColor: color }}\r\n                                    />\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <DialogFooter>\r\n                        <Button variant=\"outline\" onClick={() => setDialogOpen(false)} className=\"border-slate-700 hover:bg-slate-800\">İptal</Button>\r\n                        <Button onClick={handleSave} className=\"bg-purple-600 hover:bg-purple-700 text-white\">Kaydet</Button>\r\n                    </DialogFooter>\r\n                </DialogContent>\r\n            </Dialog>\r\n        </div>\r\n    )\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\deniz\\.gemini\\antigravity\\scratch\\oracle-crm\\components\\ui\\alert.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\deniz\\.gemini\\antigravity\\scratch\\oracle-crm\\components\\ui\\badge.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\deniz\\.gemini\\antigravity\\scratch\\oracle-crm\\components\\ui\\button.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\deniz\\.gemini\\antigravity\\scratch\\oracle-crm\\components\\ui\\calendar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\deniz\\.gemini\\antigravity\\scratch\\oracle-crm\\components\\ui\\card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\deniz\\.gemini\\antigravity\\scratch\\oracle-crm\\components\\ui\\collapsible.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\deniz\\.gemini\\antigravity\\scratch\\oracle-crm\\components\\ui\\dialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\deniz\\.gemini\\antigravity\\scratch\\oracle-crm\\components\\ui\\input.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\deniz\\.gemini\\antigravity\\scratch\\oracle-crm\\components\\ui\\label.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\deniz\\.gemini\\antigravity\\scratch\\oracle-crm\\components\\ui\\popover.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\deniz\\.gemini\\antigravity\\scratch\\oracle-crm\\components\\ui\\scroll-area.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\deniz\\.gemini\\antigravity\\scratch\\oracle-crm\\components\\ui\\select.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\deniz\\.gemini\\antigravity\\scratch\\oracle-crm\\components\\ui\\separator.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\deniz\\.gemini\\antigravity\\scratch\\oracle-crm\\components\\ui\\switch.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\deniz\\.gemini\\antigravity\\scratch\\oracle-crm\\components\\ui\\table.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\deniz\\.gemini\\antigravity\\scratch\\oracle-crm\\components\\ui\\tabs.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\deniz\\.gemini\\antigravity\\scratch\\oracle-crm\\components\\ui\\textarea.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\deniz\\.gemini\\antigravity\\scratch\\oracle-crm\\eslint.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\deniz\\.gemini\\antigravity\\scratch\\oracle-crm\\lib\\supabase.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":31,"column":6,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":31,"endColumn":9,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1025,1028],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1025,1028],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport { createClient } from '@supabase/supabase-js'\r\n\r\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL\r\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY\r\n\r\nlet client\r\n\r\ntry {\r\n    // Ensure both are strings and have valid length\r\n    if (\r\n        typeof supabaseUrl === 'string' &&\r\n        supabaseUrl.length > 0 &&\r\n        supabaseUrl !== 'your-project-url' && // Check for default placeholder\r\n        typeof supabaseAnonKey === 'string' &&\r\n        supabaseAnonKey.length > 0\r\n    ) {\r\n        client = createClient(supabaseUrl, supabaseAnonKey)\r\n    }\r\n} catch (error) {\r\n    console.warn('Supabase client initialization failed:', error)\r\n}\r\n\r\n// Fallback mock client\r\nconst mockClient = {\r\n    from: () => ({\r\n        select: () => Promise.resolve({ data: [], error: { message: 'Supabase not configured' } }),\r\n        insert: () => Promise.resolve({ data: null, error: { message: 'Supabase not configured' } }),\r\n    }),\r\n    auth: undefined // ensuring 'auth' in client is false\r\n} as any\r\n\r\nexport const supabase = client || mockClient\r\nexport const isSupabaseConfigured = !!client\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\deniz\\.gemini\\antigravity\\scratch\\oracle-crm\\lib\\utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\deniz\\.gemini\\antigravity\\scratch\\oracle-crm\\next.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\deniz\\.gemini\\antigravity\\scratch\\oracle-crm\\postcss.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]